<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>jQuery ScrollWatch 1.2</title>
<style type="text/css">
html,body {height:100%;}
body {padding: 62px 1em 1em 1em; font-family: sans-serif;}
h1 {margin-top: 0; font-size: 2em;}
h2 {margin-top: 0; font-size: 1.5em;}
h3 {font-size: 1.2em; text-decoration: underline;}
a {color: #238923; text-decoration: none;}
ul.menu {position: fixed; left: 0; top: 0; margin: 0; padding: 0; width: 100%; border-bottom: 1px solid #808080; background-color: #ccc; font-weight: bold;}
ul.menu > li {float: left; list-style-type: none;}
ul.menu > li.active {background-color: #999;}
ul.menu > li.active > a {color: #fff;}
ul.menu > li > a {display: block; padding: 1em; color: #000;}
body > ul.menu {z-index: 10;}
div.section {margin: 3em 0; padding: 2em; border-width: 1px 0; border-style: dashed; border-color: #808080; background-color: #eee;}
table th, table td {border: 1px solid #808080; padding: 0.2em 0.5em;}
table th {text-align: left;}
#custom_scroller {width: 700px; border: 1px solid #808080;}
#custom_scroller > ul.menu {position: static; height: 52px; width: auto;}
#custom_scroller > div {height: 300px; position: relative; overflow: scroll; background-color: #eee;}
#custom_scroller > div > div {border-bottom: 1px solid #808080; line-height: 300px; font-size: 70px; text-align: center;}
</style>
</head>

<body>

<ul class="menu">
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#usage">Usage</a></li>
  <li><a href="#options">Options</a></li>
  <li><a href="#return_value">Return value</a></li>
  <li><a href="#custom_scroller">Custom scroller</a></li>
</ul>

<div class="section" id="intro">

    <h1>jQuery ScrollWatch 1.2</h1>
    <p>jQuery plugin to implement navigation or any other functionality based on current scrolling position of the page or inside a custom element.</p>

    <h2>Browser support</h2>
    <p>Tested in Firefox, Google Chrome, Safari, Opera and MSIE 7+</p>

</div>

<div class="section" id="usage">

    <h2>Usage</h2>

    <p>The plugin provides two jQuery methods you can use.</p>


    <h3><code>$(<em>sectionSelector</em>).scrollWatch(<em>options</em>);</code></h3>
    <p>This is the &quot;main&quot; method. It attaches scrollwatch to the given scroller (<code>window</code> by default) and matches sections according to current scrolling  position.</p>
    <p>It is up to you to implement what is going to happen.</p>

    <pre>
    $(window).load(function () {

        var scrollWatch = $('div.section').scrollWatch({
            callback: function (focus) {
                // do something based on current focus
            }
            // more options here
        });

    });
    </pre>


    <h3><code>$(<em>menuSelector</em>).scrollWatchMenu(<em>sectionSelector</em>, <em>options</em>);</code></h3>
    <p>This method makes it easy to show active section in a navigation menu.</p>

    <pre>
    $(window).load(function () {

        var scrollWatch = $('ul#menu').scrollWatchMenu('div.section', {
            // options here
        });

    });
    </pre>

</div>

<div class="section" id="options">

    <h2>Options</h2>
    <table>
    <thead>
    <tr>
        <th>Name</th>
        <th>Default</th>
        <th>Description</th>
    </tr>
    </thead>

    <tbody>

    <tr>
        <th>scroller</th>
        <td>window</td>
        <td>element to watch for scrolling events</td>
    </tr>

    <tr>
        <th>resolutionMode</th>
        <td>0</td>
        <td>
            Determines how the active section is chosen
            <ul>
                <li><strong>0</strong> - section that is occupying the largest portion of the view is chosen</li>
                <li><strong>1</strong> - section that is directly in intersection or nearest to the focus line is chosen</li>
            </ul>
        </td>
    </tr>

    <tr>
        <th>callback</th>
        <td><em>required</em></td>
        <td>
            Callback invoked when the focus is updated. It is passed three arguments:
            <ol>
                <li>object with following properties (or array of those objects if multiMode = true):
                    <ul>
                        <li><strong>index</strong> - section number (0 based)</li>
                        <li><strong>focusHeight</strong> - null or height of the section's visible area</li>
                        <li><strong>focusIntersection</strong> - null or an array with top coordinate as element 0 and bottom coordinate as element 1</li>
                        <li><strong>elem</strong> - DOM element of the section</li>
                        <li><strong>isFull</strong> - indicates that the section is entirely in the view area</li>
                        <li><strong>asClosest</strong> - indicates that the section was chosen as closest (because no section was directly in the view)</li>
                    </ul>
                </li>
                <li>top coordinate of the view</li>
                <li>bottom coordinate of the view</li>
            </ol>
        </td>
    </tr>

    <tr>
        <th>focusRatio</th>
        <td>0.3819..</td>
        <td>Percentage of the view height that determines position of the focus line.</td>
    </tr>
    
    <tr>
      <th>debugFocusLine</th>
      <td>false</td>
      <td>Display position of the focus line (for debugging purposes).</td>
    </tr>

    <tr>
        <th>topDownWeight</th>
        <td>0</td>
        <td>Extra focus height added to the section if it preceedes the other (used in resolutionMode 0 only).</td>
    </tr>

    <tr>
        <th>viewMarginTop</th>
        <td>0</td>
        <td>Height of an area at the top of the view to be excluded (e.g. navigation menu with position: fixed).</td>
    </tr>

    <tr>
        <th>viewMarginBottom</th>
        <td>0</td>
        <td>Height of an area at the bottom of the view to be excluded (e.g. navigation menu with position: fixed).</td>
    </tr>

    <tr>
        <th>multiMode</th>
        <td>false</td>
        <td>Enabling this turns 'focus' argument of callback into an array and no resolution is performed.</td>
    </tr>

    </tbody>
    </table>

    <h3>Menu options</h3>
    <p>These options are active only when <code>$(<em>menuSelector</em>).scrollWatchMenu(<em>sectionSelector</em>, <em>options</em>);</code> is used.</p>

    <table>
    <thead>
    <tr>
        <th>Name</th>
        <th>Default</th>
        <th>Description</th>
    </tr>
    </thead>

    <tbody>

    <tr>
        <th>menuActiveClass</th>
        <td>active</td>
        <td>Class of the active menu item.</td>
    </tr>

    <tr>
        <th>menuItemSelector</th>
        <td>*</td>
        <td>Selector to match menu items, <code>*</code> matches all direct children of the menu element.</td>
    </tr>

    <tr>
        <th>menuScrollOffset</th>
        <td>0</td>
        <td>Scroll offset applied when a menu link containing a hash is clicked.</td>
    </tr>

    <tr>
        <th>menuScrollSpeed</th>
        <td>500</td>
        <td>Scroll animation speed, <code>0</code> to disable.</td>
    </tr>

    <tr>
        <th>menuInitialHashOffsetTolerance</th>
        <td>40</td>
        <td>Maximum scroll position difference to apply the <code>menuScrollOffset</code> after page load.</td>
    </tr>

    </tbody>
    </table>

</div>

<div class="section" id="return_value">

    <h2>Return value</h2>
    <p>Both <code>$(<em>selector</em>).scrollWatch(<em>options</em>);</code> and <code>$(<em>menuSelector</em>).scrollWatchMenu(<em>sectionSelector</em>, <em>options</em>);</code> return <code>false</code> on failure or an object with following properties:</p>
    <ul>
        <li><strong>update</strong> - function to recalculate section boundaries and update current focus</li>
        <li><strong>unbind</strong> - function to unbind and disable the scrollwatch instance</li>
        <li><strong>pause</strong> - function to suspend focus update</li>
        <li><strong>resume</strong> - function to resume focus update</li>
    </ul>

    <h3>Notes</h3>
    <ul>
        <li>.update() function should be called on the scrollwatch instance if size of contents in the scroller element (usually entire page) change dynamically (ajax-loaded contents, open/close features etc.)</li>
        <li>if applied to specific element (instead of window), that element should have <em>position: relative</em> or <em>absolute</em></li>
    </ul>

</div>

<div class="section" id="custom_scroller">

    <h2>Custom scroller element example</h2>

    <ul class="menu">
        <li><a href="#custom_1">1</a></li>
        <li><a href="#custom_2">2</a></li>
        <li><a href="#custom_3">3</a></li>
        <li><a href="#custom_4">4</a></li>
        <li><a href="#custom_5">5</a></li>
    </ul>

    <div>
    <div id="custom_1">1</div>
    <div id="custom_2">2</div>
    <div id="custom_3">3</div>
    <div id="custom_4">4</div>
    <div id="custom_5">5</div>
    </div>

</div>

<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript" src="jquery.scrollwatch.min.js"></script>

<script type="text/javascript">
$(window).load(function () {

    // main menu
    $('body > ul.menu').scrollWatchMenu('div.section', {
        resolutionMode: 1, // use focus line mode
        viewMarginTop: 53,  // part of the view is covered by the fixed navigation menu
        menuScrollOffset: -120 // anchors scroll this much above the actual position
    });

    // custom scroller menu
    $('#custom_scroller > ul.menu').scrollWatchMenu('#custom_scroller > div > div', {
        scroller: $('#custom_scroller > div').get(0),
        menuScrollOffset: -125 // anchors scroll this much above the actual position
    });

});
</script>

</body>
</html>